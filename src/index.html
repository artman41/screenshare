<html>
<head>
    <title>frame test</title>
</head>
<body>

<!-- <canvas id="frame_canvas" style="width: 1872; height: 1404; border: black solid 1px;"></canvas> -->
<image id="frame_image" style="border: black solid 1px;"></image>

<script>
let ws = new WebSocket("ws://127.0.0.1:9001");
<!--ws.binaryType = "arraybuffer";-->
function onWebsocketMsg(event) {
    console.log("%O got message %O", this, event);
    let blobUrl = URL.createObjectURL(event.data);
    console.log("Blob url is %O", blobUrl);
    let imageTag = document.getElementById("frame_image");
    imageTag.src = blobUrl;
    imageTag.onload = function() { context.drawImage(image, 0, 0); };

    if ( event.data instanceof ArrayBuffer ) {
        /*
        var byteArray = new Uint8Array( event.data );
        let canvas = document.getElementById("frame_canvas");
        var context = canvas.getContext('2d');
        var imgData = context.createImageData(parseInt(canvas.style.width, 10), parseInt(canvas.style.height, 10));
        for ( var i = 0; i < byteArray.length; i++ ) {
            imgData.data[i] = byteArray[i];
        }
        context.putImageData( imgData, 0, 0 );
        */
    }
}
ws.onmessage = onWebsocketMsg.bind(ws);

ws.onopen = event => ws.send("test");
</script>

</body>
</html>